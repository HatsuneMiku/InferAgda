\agdaIgnore{
\begin{code}%
\>\<%
\\
\>\AgdaKeyword{module} \AgdaModule{Term} \AgdaKeyword{where}\<%
\\
%
\\
\>\AgdaComment{--------------------------------------------------------------------------------}\<%
\\
%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Nat}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Vec} \<[21]%
\>[21]\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Product}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Fin} \AgdaKeyword{hiding} \AgdaSymbol{(}\_+\_\AgdaSymbol{;} \_≤\_\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Maybe}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Sum}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{lib}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary.PropositionalEquality}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{Relation.}\AgdaModule{Binary.}\AgdaModule{PropositionalEquality.}\AgdaModule{≡-Reasoning}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary.HeterogeneousEquality}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{renaming} \AgdaSymbol{(}sym \AgdaSymbol{to} hsym\AgdaSymbol{;} trans \AgdaSymbol{to} htrans\AgdaSymbol{;} cong \AgdaSymbol{to} hcong\AgdaSymbol{;} cong₂ \AgdaSymbol{to} hcong₂\AgdaSymbol{;} subst \AgdaSymbol{to} hsubst\AgdaSymbol{;} subst₂ \AgdaSymbol{to} hsubst₂\AgdaSymbol{;} refl \AgdaSymbol{to} hrefl\AgdaSymbol{)}\<%
\\
\>\AgdaComment{--open Relation.Binary.HeterogeneousEquality}\<%
\\
\>\AgdaKeyword{private} \AgdaKeyword{module} \AgdaModule{H} \AgdaSymbol{=} \AgdaModule{≅-Reasoning}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Nat.Properties}\<%
\\
\> \AgdaComment{-- for the concrete record, such as isCommutativeSemiring}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Algebra.Structures}\<%
\\
\> \AgdaComment{-- for type definitions, such as IsCommutativeSemiring}\<%
\\
\>\AgdaKeyword{private} \AgdaKeyword{module} \AgdaModule{M} \AgdaSymbol{=} \AgdaModule{IsCommutativeSemiring}\<%
\\
%
\\
\>\AgdaFunction{+-right-identity} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{n} \AgdaSymbol{→} \AgdaBound{n} \AgdaPrimitive{+} \AgdaNumber{0} \AgdaDatatype{≡} \AgdaBound{n}\<%
\\
\>\AgdaFunction{+-right-identity} \AgdaSymbol{=} \AgdaField{proj₂} \AgdaSymbol{(}\AgdaFunction{M.+-identity} \AgdaFunction{isCommutativeSemiring}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{+-left-identity} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{n} \AgdaSymbol{→} \AgdaNumber{0} \AgdaPrimitive{+} \AgdaBound{n} \AgdaDatatype{≡} \AgdaBound{n}\<%
\\
\>\AgdaFunction{+-left-identity} \AgdaSymbol{=} \AgdaField{proj₁} \AgdaSymbol{(}\AgdaFunction{M.+-identity} \AgdaFunction{isCommutativeSemiring}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{+-assoc} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{m} \AgdaBound{n} \AgdaBound{o} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{m} \AgdaPrimitive{+} \AgdaBound{n}\AgdaSymbol{)} \AgdaPrimitive{+} \AgdaBound{o} \AgdaDatatype{≡} \<[35]%
\>[35]\AgdaBound{m} \AgdaPrimitive{+} \AgdaSymbol{(}\AgdaBound{n} \AgdaPrimitive{+} \AgdaBound{o}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{+-assoc} \AgdaSymbol{=} \AgdaFunction{M.+-assoc} \AgdaFunction{isCommutativeSemiring}\<%
\\
%
\\
\>\AgdaFunction{+-comm} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{m} \AgdaBound{n} \AgdaSymbol{→} \AgdaBound{m} \AgdaPrimitive{+} \AgdaBound{n} \AgdaDatatype{≡} \<[26]%
\>[26]\AgdaBound{n} \AgdaPrimitive{+} \AgdaBound{m}\<%
\\
\>\AgdaFunction{+-comm} \AgdaSymbol{=} \AgdaFunction{M.+-comm} \AgdaFunction{isCommutativeSemiring}\<%
\\
%
\\
\>\AgdaFunction{+-suc} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{m} \AgdaBound{n} \AgdaSymbol{→} \AgdaBound{m} \AgdaPrimitive{+} \AgdaInductiveConstructor{suc} \AgdaBound{n} \AgdaDatatype{≡} \AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaBound{m} \AgdaPrimitive{+} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{+-suc} \AgdaInductiveConstructor{zero} \AgdaBound{n} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{+-suc} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaBound{n} \AgdaSymbol{=} \AgdaFunction{cong} \AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaFunction{+-suc} \AgdaBound{m} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{suc+-lem} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{m} \AgdaBound{n} \AgdaBound{l} \AgdaSymbol{→} \<[22]%
\>[22]\AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaBound{l} \AgdaPrimitive{+} \AgdaSymbol{(}\AgdaBound{n} \AgdaPrimitive{+} \AgdaBound{m}\AgdaSymbol{))} \AgdaDatatype{≡} \AgdaBound{n} \AgdaPrimitive{+} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{l}\AgdaSymbol{)} \AgdaPrimitive{+} \AgdaBound{m}\<%
\\
\>\AgdaFunction{suc+-lem} \AgdaBound{m} \AgdaBound{n} \AgdaBound{l} \AgdaKeyword{rewrite} \AgdaFunction{+-suc} \AgdaBound{n} \AgdaBound{l} \AgdaSymbol{|} \AgdaFunction{sym} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{l} \AgdaBound{n} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{|} \AgdaFunction{+-comm} \AgdaBound{n} \AgdaBound{l} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaComment{-- +-suc m n rewrite +-comm m n = +-comm m (suc n)}\<%
\end{code}
}
\agdaSnippet\Cxt{
\begin{code}%
\>\AgdaComment{-- 型変数の数が m 個で長さが n の型環境}\<%
\\
\>\AgdaFunction{Cxt} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{ℕ} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n} \AgdaSymbol{=} \AgdaDatatype{Vec} \AgdaSymbol{(}\AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaBound{n}\<%
\end{code}
}
\agdaSnippet\LiftCxt{
\begin{code}%
\>\AgdaComment{-- liftCxt m' Γ : Γ の中の型変数の数を m' だけ増やす}\<%
\\
\>\AgdaFunction{liftCxt} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{m'} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n} \AgdaSymbol{→} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m'} \AgdaPrimitive{+} \AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\<%
\\
\>\AgdaFunction{liftCxt} \AgdaBound{m'} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{Γ} \AgdaSymbol{=} \AgdaFunction{Data.Vec.map} \AgdaSymbol{(}\AgdaFunction{▹◃} \AgdaSymbol{(}\AgdaFunction{inject+'} \AgdaBound{m'}\AgdaSymbol{))} \AgdaBound{Γ}\<%
\end{code}
}
\agdaSnippet\LiftCxtZero{
\begin{code}%
\>\AgdaFunction{liftCxtZero} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{liftCxt} \AgdaNumber{0} \AgdaBound{Γ} \AgdaDatatype{≡} \AgdaBound{Γ}\<%
\\
\>\AgdaFunction{liftCxtZero} \AgdaInductiveConstructor{[]} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{liftCxtZero} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{cong₂} \AgdaInductiveConstructor{\_∷\_} \AgdaSymbol{(}\AgdaFunction{TVarId} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftCxtZero} \AgdaBound{Γ}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\SubstCxt{
\begin{code}%
\>\AgdaComment{-- substCxt σ Γ : Γ に σ を適用した型環境を返す}\<%
\\
\>\AgdaFunction{substCxt} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{m'} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{m'} \AgdaSymbol{→} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n} \AgdaSymbol{→} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m'}\AgdaSymbol{\}} \AgdaBound{n} \<[62]%
\>[62]\<%
\\
\>\AgdaFunction{substCxt} \AgdaBound{σ} \AgdaBound{Γ} \AgdaSymbol{=} \AgdaFunction{Data.Vec.map} \AgdaSymbol{(}\AgdaFunction{substType} \AgdaBound{σ}\AgdaSymbol{)} \AgdaBound{Γ} \<%
\end{code}
}
\agdaSnippet\SubstCxtAnil{
\begin{code}%
\>\AgdaComment{-- substCxt anil Γ は Γ と同じ}\<%
\\
\>\AgdaFunction{substCxtAnil} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{substCxt} \AgdaInductiveConstructor{anil} \AgdaBound{Γ} \AgdaDatatype{≡} \AgdaBound{Γ} \<[65]%
\>[65]\<%
\\
\>\AgdaFunction{substCxtAnil} \AgdaInductiveConstructor{[]} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{substCxtAnil} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{cong₂} \AgdaInductiveConstructor{\_∷\_} \AgdaSymbol{(}\AgdaFunction{TVarId} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{substCxtAnil} \AgdaBound{Γ}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\WellScopedTerm{
\begin{code}%
\>\AgdaComment{-- 自由変数の数が n 個の well-scope な項}\<%
\\
\>\AgdaKeyword{data} \AgdaDatatype{WellScopedTerm} \AgdaSymbol{(}\AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{)} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{Var} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{n} \AgdaSymbol{→} \AgdaDatatype{WellScopedTerm} \AgdaBound{n}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{Lam} \AgdaSymbol{:} \AgdaDatatype{WellScopedTerm} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{WellScopedTerm} \AgdaBound{n}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{App} \AgdaSymbol{:} \AgdaDatatype{WellScopedTerm} \AgdaBound{n} \AgdaSymbol{→} \AgdaDatatype{WellScopedTerm} \AgdaBound{n} \AgdaSymbol{→} \AgdaDatatype{WellScopedTerm} \AgdaBound{n}\<%
\end{code}
}
\agdaSnippet\WellTypedTerm{
\begin{code}%
\>\AgdaComment{-- WellTypedTerm Γ t : 自由変数の数が n 個、型が t であるような well-typed な項}\<%
\\
\>\AgdaKeyword{data} \AgdaDatatype{WellTypedTerm} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{Var} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{WellTypedTerm} \AgdaBound{Γ} \AgdaSymbol{(}\AgdaFunction{lookup} \AgdaBound{x} \AgdaBound{Γ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{Lam} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{t'} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{WellTypedTerm} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaBound{t'} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaDatatype{WellTypedTerm} \AgdaBound{Γ} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{⇒} \AgdaBound{t'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{App} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{t} \AgdaBound{t'} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{WellTypedTerm} \AgdaBound{Γ} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{⇒} \AgdaBound{t'}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{WellTypedTerm} \AgdaBound{Γ} \AgdaBound{t} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaDatatype{WellTypedTerm} \AgdaBound{Γ} \AgdaBound{t'}\<%
\end{code}
}
\agdaSnippet\LookupLiftCxtCommute{
\begin{code}%
\>\AgdaComment{-- lookup と liftCxt は順番を変えても良い}\<%
\\
\>\AgdaFunction{lookupLiftCxtCommute} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{m'} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{)} \AgdaSymbol{\{}\AgdaBound{n} \AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[8]\AgdaIndent{23}{}\<[23]%
\>[23]\AgdaFunction{liftType} \AgdaBound{m'} \AgdaSymbol{(}\AgdaFunction{lookup} \AgdaBound{x} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaFunction{lookup} \AgdaBound{x} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{m'} \AgdaBound{Γ}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lookupLiftCxtCommute} \AgdaBound{m'} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{()} \AgdaBound{Γ}\<%
\\
\>\AgdaFunction{lookupLiftCxtCommute} \AgdaBound{m'} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lookupLiftCxtCommute} \AgdaBound{m'} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{lookupLiftCxtCommute} \AgdaBound{m'} \AgdaBound{x} \AgdaBound{Γ}\<%
\end{code}
}
\agdaSnippet\LiftWTerm{
\begin{code}%
\>\AgdaComment{-- WellTypedTerm を lift する}\<%
\\
\>\AgdaFunction{liftWTerm} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{m'} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{)} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{WellTypedTerm} \AgdaBound{Γ} \AgdaBound{t} \AgdaSymbol{→}\<%
\\
\>[0]\AgdaIndent{12}{}\<[12]%
\>[12]\AgdaDatatype{WellTypedTerm} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{m'} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaBound{m'} \AgdaBound{t}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{liftWTerm} \AgdaBound{m'} \AgdaSymbol{\{}\AgdaArgument{Γ} \AgdaSymbol{=} \AgdaBound{Γ}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{Var} \AgdaBound{x}\AgdaSymbol{)} \AgdaKeyword{rewrite} \AgdaFunction{lookupLiftCxtCommute} \AgdaBound{m'} \AgdaBound{x} \AgdaBound{Γ} \AgdaSymbol{=} \AgdaInductiveConstructor{Var} \AgdaBound{x}\<%
\\
\>\AgdaFunction{liftWTerm} \AgdaBound{m'} \AgdaSymbol{(}\AgdaInductiveConstructor{Lam} \AgdaBound{t} \AgdaBound{w}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{Lam} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaBound{m'} \AgdaBound{t}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftWTerm} \AgdaBound{m'} \AgdaBound{w}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{liftWTerm} \AgdaBound{m'} \AgdaSymbol{(}\AgdaInductiveConstructor{App} \AgdaBound{w1} \AgdaBound{w2}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{App} \AgdaSymbol{(}\AgdaFunction{liftWTerm} \AgdaBound{m'} \AgdaBound{w1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftWTerm} \AgdaBound{m'} \AgdaBound{w2}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\LookupSubstCxtCommute{
\begin{code}%
\>\AgdaComment{-- lookup と substCxt は順番を変えても良い}\<%
\\
\>\AgdaFunction{lookupSubstCxtCommute} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{n} \AgdaBound{m'} \AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{σ} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{m'}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[12]\AgdaIndent{23}{}\<[23]%
\>[23]\AgdaFunction{substType} \AgdaBound{σ} \AgdaSymbol{(}\AgdaFunction{lookup} \AgdaBound{x} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaFunction{lookup} \AgdaBound{x} \AgdaSymbol{(}\AgdaFunction{substCxt} \AgdaBound{σ} \AgdaBound{Γ}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lookupSubstCxtCommute} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{()} \AgdaBound{Γ} \AgdaBound{σ}\<%
\\
\>\AgdaFunction{lookupSubstCxtCommute} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaBound{σ} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lookupSubstCxtCommute} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaBound{σ} \AgdaSymbol{=} \AgdaFunction{lookupSubstCxtCommute} \AgdaBound{x} \AgdaBound{Γ} \AgdaBound{σ}\<%
\end{code}
}
\agdaSnippet\SubstWTerm{
\begin{code}%
\>\AgdaComment{-- substWTerm σ w : w に σ を適用した WellTypedTerm を返す}\<%
\\
\>\AgdaFunction{substWTerm} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m'} \AgdaBound{m} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{→}\<%
\\
\>[0]\AgdaIndent{13}{}\<[13]%
\>[13]\AgdaSymbol{(}\AgdaBound{σ} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{m'}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{WellTypedTerm} \AgdaBound{Γ} \AgdaBound{t} \AgdaSymbol{→} \AgdaDatatype{WellTypedTerm} \AgdaSymbol{(}\AgdaFunction{substCxt} \AgdaBound{σ} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{substType} \AgdaBound{σ} \AgdaBound{t}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{substWTerm} \AgdaSymbol{\{}\AgdaArgument{Γ} \AgdaSymbol{=} \AgdaBound{Γ}\AgdaSymbol{\}} \AgdaBound{σ} \AgdaSymbol{(}\AgdaInductiveConstructor{Var} \AgdaBound{x}\AgdaSymbol{)} \AgdaKeyword{rewrite} \AgdaFunction{lookupSubstCxtCommute} \AgdaBound{x} \AgdaBound{Γ} \AgdaBound{σ} \AgdaSymbol{=} \AgdaInductiveConstructor{Var} \AgdaBound{x}\<%
\\
\>\AgdaFunction{substWTerm} \AgdaBound{σ} \AgdaSymbol{(}\AgdaInductiveConstructor{Lam} \AgdaBound{t} \AgdaBound{w}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{Lam} \AgdaSymbol{(}\AgdaFunction{substType} \AgdaBound{σ} \AgdaBound{t}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{substWTerm} \AgdaBound{σ} \AgdaBound{w}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{substWTerm} \AgdaBound{σ} \AgdaSymbol{(}\AgdaInductiveConstructor{App} \AgdaBound{w1} \AgdaBound{w2}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{App} \AgdaSymbol{(}\AgdaFunction{substWTerm} \AgdaBound{σ} \AgdaBound{w1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{substWTerm} \AgdaBound{σ} \AgdaBound{w2}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\Unify{
\begin{code}%
\>\AgdaComment{-- unify t1 t2 : 型変数が m 個であるような型 t1 と t2 を unify する代入を返す}\<%
\\
%
\\
\>\AgdaFunction{unify} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaSymbol{(}\AgdaFunction{Σ[} \AgdaBound{n} \AgdaFunction{∈} \AgdaDatatype{ℕ} \AgdaFunction{]} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{unify} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{t1} \AgdaBound{t2} \AgdaSymbol{=} \AgdaFunction{mgu} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{t1} \AgdaBound{t2}\<%
\end{code}
}
\agdaSnippet\UnifyTwo{
\begin{code}%
\>\AgdaComment{-- unify2 t1 t2 : 型変数が m 個であるような型 t1 と t2 を unify する代入を返す}\<%
\\
\>\AgdaFunction{unify2} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{s} \AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaDatatype{Maybe} \AgdaSymbol{(}\AgdaFunction{Σ[} \AgdaBound{n} \AgdaFunction{∈} \AgdaDatatype{ℕ} \AgdaFunction{]} \AgdaFunction{Σ[} \AgdaBound{σ} \AgdaFunction{∈} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{n} \AgdaFunction{]} \AgdaFunction{substType} \AgdaBound{σ} \AgdaBound{s} \AgdaDatatype{≡} \AgdaFunction{substType} \AgdaBound{σ} \AgdaBound{t}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{unify2} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{t1} \AgdaBound{t2} \AgdaSymbol{=} \AgdaFunction{mgu2} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{t1} \AgdaBound{t2}\<%
\end{code}
}
\agdaSnippet\Count{
\begin{code}%
\>\AgdaComment{--Well-scope な項の中の Lam と App のノード数を数える}\<%
\\
\>\AgdaComment{-- （その数が、新たに導入される型変数の数になる）}\<%
\\
\>\AgdaFunction{count} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{s} \AgdaSymbol{:} \AgdaDatatype{WellScopedTerm} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{ℕ}\<%
\\
\>\AgdaFunction{count} \AgdaSymbol{(}\AgdaInductiveConstructor{Var} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{zero}\<%
\\
\>\AgdaFunction{count} \AgdaSymbol{(}\AgdaInductiveConstructor{Lam} \AgdaBound{s}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaFunction{count} \AgdaBound{s}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{count} \AgdaSymbol{(}\AgdaInductiveConstructor{App} \AgdaBound{s1} \AgdaBound{s2}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{count} \AgdaBound{s1} \AgdaPrimitive{+} \AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaFunction{count} \AgdaBound{s2}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\HeteroGeneouses{
\begin{code}%
\>\AgdaComment{-- hsubst の heterogeneous 版}\<%
\\
\>\AgdaFunction{hsubst'} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b} \AgdaBound{c}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{I} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{i} \AgdaBound{j} \AgdaSymbol{:} \AgdaBound{I}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{:} \AgdaBound{I} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{b}\AgdaSymbol{)} \AgdaSymbol{\{}\AgdaBound{x'} \AgdaSymbol{:} \AgdaBound{A} \AgdaBound{i}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y} \AgdaSymbol{:} \AgdaBound{A} \AgdaBound{j}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{→} \AgdaBound{i} \AgdaDatatype{≡} \AgdaBound{j}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{P} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{i} \AgdaSymbol{:} \AgdaBound{I}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{A} \AgdaBound{i} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{c}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{→} \AgdaBound{x'} \AgdaDatatype{≅} \AgdaBound{y}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{→} \AgdaBound{P} \AgdaBound{x'} \AgdaSymbol{→} \AgdaBound{P} \AgdaBound{y}\<%
\\
\>\AgdaFunction{hsubst'} \AgdaSymbol{\_} \AgdaInductiveConstructor{refl} \AgdaBound{P} \AgdaInductiveConstructor{hrefl} \AgdaBound{px} \AgdaSymbol{=} \AgdaBound{px}\<%
\\
%
\\
\>\AgdaComment{-- hcong の heterogeneous 版}\<%
\\
\>\AgdaFunction{hcong'} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{α} \AgdaBound{β} \AgdaBound{γ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{I} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{α}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{i} \AgdaBound{j} \AgdaSymbol{:} \AgdaBound{I}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{:} \AgdaBound{I} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{β}\AgdaSymbol{)} \AgdaSymbol{\{}\AgdaBound{B} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{k} \AgdaSymbol{:} \AgdaBound{I}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{A} \AgdaBound{k} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{γ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaBound{A} \AgdaBound{i}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y} \AgdaSymbol{:} \AgdaBound{A} \AgdaBound{j}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{→} \AgdaBound{i} \AgdaDatatype{≡} \AgdaBound{j}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{k} \AgdaSymbol{:} \AgdaBound{I}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaBound{A} \AgdaBound{k}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{B} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{≅} \AgdaBound{y}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{→} \AgdaBound{f} \AgdaBound{x} \AgdaDatatype{≅} \AgdaBound{f} \AgdaBound{y}\<%
\\
\>\AgdaFunction{hcong'} \AgdaSymbol{\_} \AgdaInductiveConstructor{refl} \AgdaSymbol{\_} \AgdaInductiveConstructor{hrefl} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\\
%
\\
\>\AgdaComment{-- hcong₂ の heterogeneous 版}\<%
\\
\>\AgdaFunction{hcong₂'} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{a} \AgdaBound{b} \AgdaBound{c} \AgdaBound{d}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{I} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{i1} \AgdaBound{i2} \AgdaSymbol{:} \AgdaBound{I}\AgdaSymbol{\}}\<%
\\
\>[7]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{:} \AgdaBound{I} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{b}\AgdaSymbol{)}\<%
\\
\>[7]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{(}\AgdaBound{B} \AgdaSymbol{:} \AgdaBound{I} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{c}\AgdaSymbol{)}\<%
\\
\>[7]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{\{}\AgdaBound{C} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{i} \AgdaSymbol{:} \AgdaBound{I}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{A} \AgdaBound{i} \AgdaSymbol{→} \AgdaBound{B} \AgdaBound{i} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaBound{d}\AgdaSymbol{\}}\<%
\\
\>[7]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaBound{A} \AgdaBound{i1}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y} \AgdaSymbol{:} \AgdaBound{A} \AgdaBound{i2}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{u} \AgdaSymbol{:} \AgdaBound{B} \AgdaBound{i1}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{v} \AgdaSymbol{:} \AgdaBound{B} \AgdaBound{i2}\AgdaSymbol{\}} \AgdaSymbol{→}\<%
\\
\>[0]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaBound{i1} \AgdaDatatype{≡} \AgdaBound{i2} \AgdaSymbol{→}\<%
\\
\>[0]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{i} \AgdaSymbol{:} \AgdaBound{I}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaBound{A} \AgdaBound{i}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{y} \AgdaSymbol{:} \AgdaBound{B} \AgdaBound{i}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{C} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{≅} \AgdaBound{y} \AgdaSymbol{→} \AgdaBound{u} \AgdaDatatype{≅} \AgdaBound{v} \AgdaSymbol{→} \AgdaBound{f} \AgdaBound{x} \AgdaBound{u} \AgdaDatatype{≅} \AgdaBound{f} \AgdaBound{y} \AgdaBound{v}\<%
\\
\>\AgdaFunction{hcong₂'} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaInductiveConstructor{refl} \AgdaBound{f} \AgdaInductiveConstructor{hrefl} \AgdaInductiveConstructor{hrefl} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\end{code}
}
\agdaSnippet\InjectSuc{
\begin{code}%
\>\AgdaFunction{injectSuc} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaBound{m'} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{inject+'} \AgdaBound{m'} \AgdaSymbol{(}\AgdaFunction{inject₁} \AgdaBound{x}\AgdaSymbol{)} \AgdaDatatype{≅} \AgdaFunction{inject₁} \AgdaSymbol{(}\AgdaFunction{inject+'} \AgdaBound{m'} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{injectSuc} \AgdaInductiveConstructor{zero} \AgdaBound{x} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\\
\>\AgdaFunction{injectSuc} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m'}\AgdaSymbol{)} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaBound{x} \AgdaSymbol{=} \AgdaFunction{hcong'} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaFunction{+-suc} \AgdaBound{m'} \AgdaBound{n}\AgdaSymbol{)} \AgdaFunction{inject₁} \AgdaSymbol{(}\AgdaFunction{injectSuc} \AgdaBound{m'} \AgdaBound{x}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\InjectAdd{
\begin{code}%
\>\AgdaFunction{injectAdd} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{inject+'} \AgdaBound{m1} \AgdaSymbol{(}\AgdaFunction{inject+'} \AgdaBound{m2} \AgdaBound{x}\AgdaSymbol{)} \AgdaDatatype{≅} \AgdaFunction{inject+'} \AgdaSymbol{(}\AgdaBound{m1} \AgdaPrimitive{+} \AgdaBound{m2}\AgdaSymbol{)} \AgdaBound{x}\<%
\\
\>\AgdaFunction{injectAdd} \AgdaInductiveConstructor{zero} \AgdaBound{m2} \AgdaBound{x} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\\
\>\AgdaFunction{injectAdd} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m1}\AgdaSymbol{)} \AgdaBound{m2} \AgdaBound{x} \AgdaSymbol{=} \AgdaFunction{hcong'} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{m}\AgdaSymbol{))} \AgdaFunction{inject₁} \AgdaSymbol{(}\AgdaFunction{injectAdd} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{x}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\LiftTypeSuc{
\begin{code}%
\>\AgdaFunction{liftTypeSuc} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{m'} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{liftType} \AgdaBound{m'} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaNumber{1} \AgdaBound{t}\AgdaSymbol{)} \AgdaDatatype{≅} \AgdaFunction{liftType} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m'}\AgdaSymbol{)} \AgdaBound{t}\<%
\\
\>\AgdaFunction{liftTypeSuc} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m'}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{TVar} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{hcong'} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaFunction{+-suc} \AgdaBound{m'} \AgdaBound{m}\AgdaSymbol{)} \AgdaInductiveConstructor{TVar} \AgdaSymbol{(}\AgdaFunction{injectSuc} \AgdaBound{m'} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{liftTypeSuc} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m'}\AgdaSymbol{\}} \AgdaInductiveConstructor{TInt} \AgdaKeyword{rewrite} \AgdaFunction{+-suc} \AgdaBound{m'} \AgdaBound{m} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\\
\>\AgdaFunction{liftTypeSuc} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m'}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{t1} \AgdaInductiveConstructor{⇒} \AgdaBound{t2}\AgdaSymbol{)} \AgdaSymbol{=}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{hcong₂'} \AgdaDatatype{Type} \AgdaDatatype{Type} \AgdaSymbol{(}\AgdaFunction{+-suc} \AgdaBound{m'} \AgdaBound{m}\AgdaSymbol{)} \AgdaInductiveConstructor{\_⇒\_} \AgdaSymbol{(}\AgdaFunction{liftTypeSuc} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m'}\AgdaSymbol{\}} \AgdaBound{t1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftTypeSuc} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m'}\AgdaSymbol{\}} \AgdaBound{t2}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\LiftTypeAdd{
\begin{code}%
\>\AgdaFunction{liftTypeAdd} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{liftType} \AgdaBound{m1} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaBound{m2} \AgdaBound{t}\AgdaSymbol{)} \AgdaDatatype{≅} \AgdaFunction{liftType} \AgdaSymbol{(}\AgdaBound{m1} \AgdaPrimitive{+} \AgdaBound{m2}\AgdaSymbol{)} \AgdaBound{t}\<%
\\
\>\AgdaFunction{liftTypeAdd} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaSymbol{(}\AgdaInductiveConstructor{TVar} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{hcong'} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{m}\AgdaSymbol{))} \AgdaInductiveConstructor{TVar} \AgdaSymbol{(}\AgdaFunction{injectAdd} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{liftTypeAdd} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaInductiveConstructor{TInt} \AgdaKeyword{rewrite} \AgdaFunction{sym} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\\
\>\AgdaFunction{liftTypeAdd} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaSymbol{(}\AgdaBound{t1} \AgdaInductiveConstructor{⇒} \AgdaBound{t2}\AgdaSymbol{)} \AgdaSymbol{=}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{hcong₂'} \AgdaDatatype{Type} \AgdaDatatype{Type} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{m}\AgdaSymbol{))} \AgdaInductiveConstructor{\_⇒\_} \AgdaSymbol{(}\AgdaFunction{liftTypeAdd} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{t1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftTypeAdd} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{t2}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\LiftCxtSuc{
\begin{code}%
\>\AgdaFunction{liftCxtSuc} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m'} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{liftCxt} \AgdaBound{m'} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaNumber{1} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaDatatype{≅} \AgdaFunction{liftCxt} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m'}\AgdaSymbol{)} \AgdaBound{Γ}\<%
\\
\>\AgdaFunction{liftCxtSuc} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m'} \AgdaInductiveConstructor{[]} \AgdaKeyword{rewrite} \AgdaFunction{+-suc} \AgdaBound{m'} \AgdaBound{m} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\\
\>\AgdaFunction{liftCxtSuc} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m'} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaSymbol{=}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{hcong₂'} \AgdaDatatype{Type} \AgdaSymbol{(λ} \AgdaBound{m} \AgdaSymbol{→} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{+-suc} \AgdaBound{m'} \AgdaBound{m}\AgdaSymbol{)} \AgdaInductiveConstructor{\_∷\_} \AgdaSymbol{(}\AgdaFunction{liftTypeSuc} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m'}\AgdaSymbol{\}} \AgdaBound{t}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftCxtSuc} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m'} \AgdaBound{Γ}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\LiftCxtAdd{
\begin{code}%
\>\AgdaFunction{liftCxtAdd} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{liftCxt} \AgdaBound{m1} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{m2} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaDatatype{≅} \AgdaFunction{liftCxt} \AgdaSymbol{(}\AgdaBound{m1} \AgdaPrimitive{+} \AgdaBound{m2}\AgdaSymbol{)} \AgdaBound{Γ}\<%
\\
\>\AgdaFunction{liftCxtAdd} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaInductiveConstructor{[]} \AgdaKeyword{rewrite} \AgdaFunction{sym} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\\
\>\AgdaFunction{liftCxtAdd} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaSymbol{=}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{hcong₂'} \AgdaDatatype{Type} \AgdaSymbol{(λ} \AgdaBound{m} \AgdaSymbol{→} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{m}\AgdaSymbol{))} \AgdaInductiveConstructor{\_∷\_} \AgdaSymbol{(}\AgdaFunction{liftTypeAdd} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{t}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftCxtAdd} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{Γ}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\SubstCommutes{
\begin{code}%
\>\AgdaFunction{substConsCommute} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{m'} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{eq} \AgdaSymbol{:} \AgdaBound{m} \AgdaDatatype{≡} \AgdaBound{m'}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{19}{}\<[19]%
\>[19]\AgdaFunction{subst} \AgdaSymbol{(λ} \AgdaBound{m} \AgdaSymbol{→} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{))} \AgdaBound{eq} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaDatatype{≡} \<[62]%
\>[62]\<%
\\
\>[2]\AgdaIndent{19}{}\<[19]%
\>[19]\AgdaFunction{subst} \AgdaDatatype{Type} \AgdaBound{eq} \AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaFunction{subst} \AgdaSymbol{(λ} \AgdaBound{m} \AgdaSymbol{→} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaBound{eq} \AgdaBound{Γ}\<%
\\
\>\AgdaFunction{substConsCommute} \AgdaInductiveConstructor{refl} \AgdaBound{t} \AgdaBound{Γ} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaFunction{substTVarCommute} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{m'}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{eq} \AgdaSymbol{:} \AgdaBound{m} \AgdaDatatype{≡} \AgdaBound{m'}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{19}{}\<[19]%
\>[19]\AgdaFunction{subst} \AgdaDatatype{Type} \AgdaBound{eq} \AgdaSymbol{(}\AgdaInductiveConstructor{TVar} \AgdaBound{x}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaInductiveConstructor{TVar} \AgdaSymbol{(}\AgdaFunction{subst} \AgdaDatatype{Fin} \AgdaBound{eq} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{substTVarCommute} \AgdaInductiveConstructor{refl} \AgdaBound{x} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaFunction{substInject1Commute} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{m'}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{eq} \AgdaSymbol{:} \AgdaBound{m} \AgdaDatatype{≡} \AgdaBound{m'}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaFunction{subst} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaFunction{cong} \AgdaInductiveConstructor{suc} \AgdaBound{eq}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{inject₁} \AgdaBound{x}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaFunction{inject₁} \AgdaSymbol{(}\AgdaFunction{subst} \AgdaDatatype{Fin} \AgdaBound{eq} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{substInject1Commute} \AgdaInductiveConstructor{refl} \AgdaBound{x} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaFunction{substArrowCommute} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{m'}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{eq} \AgdaSymbol{:} \AgdaBound{m} \AgdaDatatype{≡} \AgdaBound{m'}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{t1} \AgdaBound{t2} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[0]\AgdaIndent{20}{}\<[20]%
\>[20]\AgdaFunction{subst} \AgdaDatatype{Type} \AgdaBound{eq} \AgdaSymbol{(}\AgdaBound{t1} \AgdaInductiveConstructor{⇒} \AgdaBound{t2}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaFunction{subst} \AgdaDatatype{Type} \AgdaBound{eq} \AgdaBound{t1} \AgdaInductiveConstructor{⇒} \AgdaFunction{subst} \AgdaDatatype{Type} \AgdaBound{eq} \AgdaBound{t2}\<%
\\
\>\AgdaFunction{substArrowCommute} \AgdaInductiveConstructor{refl} \AgdaBound{t1} \AgdaBound{t2} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\end{code}
}
\agdaSnippet\AddDash{
\begin{code}%
\>\AgdaFunction{injectAdd'} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[0]\AgdaIndent{13}{}\<[13]%
\>[13]\AgdaFunction{inject+'} \AgdaBound{m1} \AgdaSymbol{(}\AgdaFunction{inject+'} \AgdaBound{m2} \AgdaBound{x}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaFunction{subst} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{inject+'} \AgdaSymbol{(}\AgdaBound{m1} \AgdaPrimitive{+} \AgdaBound{m2}\AgdaSymbol{)} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{injectAdd'} \AgdaInductiveConstructor{zero} \AgdaBound{m2} \AgdaBound{x} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{injectAdd'} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m1}\AgdaSymbol{)} \AgdaBound{m2} \AgdaBound{x} \AgdaKeyword{rewrite} \AgdaFunction{substInject1Commute} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{inject+'} \AgdaSymbol{(}\AgdaBound{m1} \AgdaPrimitive{+} \AgdaBound{m2}\AgdaSymbol{)} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{cong} \AgdaFunction{inject₁} \AgdaSymbol{(}\AgdaFunction{injectAdd'} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{liftTypeAdd'} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{15}{}\<[15]%
\>[15]\AgdaFunction{liftType} \AgdaBound{m1} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaBound{m2} \AgdaBound{t}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaFunction{subst} \AgdaDatatype{Type} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaSymbol{(}\AgdaBound{m1} \AgdaPrimitive{+} \AgdaBound{m2}\AgdaSymbol{)} \AgdaBound{t}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{liftTypeAdd'} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaSymbol{(}\AgdaInductiveConstructor{TVar} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{rewrite} \AgdaFunction{injectAdd'} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{x} \AgdaSymbol{|} \AgdaFunction{substTVarCommute} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{inject+'} \AgdaSymbol{(}\AgdaBound{m1} \AgdaPrimitive{+} \AgdaBound{m2}\AgdaSymbol{)} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{liftTypeAdd'} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaInductiveConstructor{TInt} \AgdaKeyword{rewrite} \AgdaFunction{+-assoc} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{m} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{liftTypeAdd'} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{m1} \AgdaBound{m2} \AgdaSymbol{(}\AgdaBound{t1} \AgdaInductiveConstructor{⇒} \AgdaBound{t2}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{rewrite} \AgdaFunction{substArrowCommute} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaSymbol{(}\AgdaBound{m1} \AgdaPrimitive{+} \AgdaBound{m2}\AgdaSymbol{)} \AgdaBound{t1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaSymbol{(}\AgdaBound{m1} \AgdaPrimitive{+} \AgdaBound{m2}\AgdaSymbol{)} \AgdaBound{t2}\AgdaSymbol{)} \AgdaSymbol{=}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{cong₂} \AgdaInductiveConstructor{\_⇒\_} \AgdaSymbol{(}\AgdaFunction{liftTypeAdd'} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{t1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftTypeAdd'} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{t2}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\ThickInjectOne{
\begin{code}%
\>\AgdaFunction{thickInject1} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{))} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{15}{}\<[15]%
\>[15]\AgdaSymbol{(}\AgdaFunction{thick} \AgdaBound{x} \AgdaBound{y} \AgdaDatatype{≡} \AgdaInductiveConstructor{nothing} \AgdaFunction{×} \AgdaFunction{thick} \AgdaSymbol{(}\AgdaFunction{inject₁} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{inject₁} \AgdaBound{y}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaInductiveConstructor{nothing}\AgdaSymbol{)} \AgdaDatatype{⊎}\<%
\\
\>[2]\AgdaIndent{15}{}\<[15]%
\>[15]\AgdaSymbol{(}\AgdaFunction{Σ[} \AgdaBound{y'} \AgdaFunction{∈} \AgdaDatatype{Fin} \AgdaBound{n} \AgdaFunction{]} \AgdaFunction{thick} \AgdaBound{x} \AgdaBound{y} \AgdaDatatype{≡} \AgdaInductiveConstructor{just} \AgdaBound{y'} \AgdaFunction{×} \AgdaFunction{thick} \AgdaSymbol{(}\AgdaFunction{inject₁} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{inject₁} \AgdaBound{y}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaFunction{inject₁} \AgdaBound{y'}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{thickInject1} \AgdaInductiveConstructor{zero} \AgdaInductiveConstructor{zero} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{refl} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{thickInject1} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{refl} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{thickInject1} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaSymbol{())} \AgdaInductiveConstructor{zero}\<%
\\
\>\AgdaFunction{thickInject1} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{x}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{zero} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{refl} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{thickInject1} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaSymbol{())} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{y}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{thickInject1} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{y}\AgdaSymbol{)} \AgdaKeyword{with} \AgdaFunction{thickInject1} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{eq1} \AgdaInductiveConstructor{,} \AgdaBound{eq2}\AgdaSymbol{)} \AgdaKeyword{rewrite} \AgdaBound{eq1} \AgdaSymbol{|} \AgdaBound{eq2} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{refl} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{y'} \AgdaInductiveConstructor{,} \AgdaBound{eq1} \AgdaInductiveConstructor{,} \AgdaBound{eq2}\AgdaSymbol{)} \AgdaKeyword{rewrite} \AgdaBound{eq1} \AgdaSymbol{|} \AgdaBound{eq2} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{y'} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{refl} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\end{code}
}
\agdaSnippet\AListNoLess{
\begin{code}%
\>\AgdaFunction{AListNoLess} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{σ} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{n} \AgdaDatatype{≤′} \AgdaBound{m}\<%
\\
\>\AgdaFunction{AListNoLess} \AgdaInductiveConstructor{anil} \AgdaSymbol{=} \AgdaInductiveConstructor{≤′-refl}\<%
\\
\>\AgdaFunction{AListNoLess} \AgdaSymbol{(}\AgdaBound{σ} \AgdaInductiveConstructor{asnoc} \AgdaBound{t'} \AgdaInductiveConstructor{/} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{≤′-step} \AgdaSymbol{(}\AgdaFunction{AListNoLess} \AgdaBound{σ}\AgdaSymbol{)}\<%
\end{code}
}
\agdaIgnore{
\begin{code}%
\>\AgdaKeyword{mutual}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{liftSub1Commute} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m'} \AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{σ} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m'} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m'}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{20}{}\<[20]%
\>[20]\AgdaFunction{liftType} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{sub} \AgdaBound{σ} \AgdaBound{x}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaFunction{sub} \AgdaSymbol{(}\AgdaFunction{liftAList1} \AgdaBound{σ}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{inject₁} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>\AgdaComment{--   liftSub1Commute σ x with AListNoLess σ}\<%
\\
\>\AgdaComment{--   ... | ≤′-refl = \{!!\}}\<%
\\
\>\AgdaComment{--   ... | ≤′-step a = \{!!\}}\<%
\\
\>\AgdaComment{--  liftSub1Commute \{zero\} anil x = refl}\<%
\\
\>\AgdaComment{--  liftSub1Commute \{zero\} (σ asnoc t' / x) x₁ = \{!!\}}\<%
\\
\>\AgdaComment{--  liftSub1Commute \{suc s\} σ x = \{!!\}}\<%
\\
\>\AgdaComment{--  以下の定義は termination check にひっかかる。AList の長さについて再帰したいが、}\<%
\\
\>\AgdaComment{--  AList (s + m) m の s で再帰するのではうまくいかない。AList の定義を変更しなくてはだめか。}\<%
\\
\>\AgdaComment{--  と思ったが、1 の場合だけを切り出して、相互再帰させたらうまくいった！！！}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{liftSub1Commute} \AgdaInductiveConstructor{anil} \AgdaBound{x} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{liftSub1Commute} \AgdaSymbol{(}\AgdaBound{σ} \AgdaInductiveConstructor{asnoc} \AgdaBound{t} \AgdaInductiveConstructor{/} \AgdaBound{y}\AgdaSymbol{)} \AgdaBound{x} \AgdaKeyword{with} \AgdaFunction{thickInject1} \AgdaBound{y} \AgdaBound{x}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaBound{eq1} \AgdaInductiveConstructor{,} \AgdaBound{eq2}\AgdaSymbol{)} \AgdaKeyword{rewrite} \AgdaBound{eq1} \AgdaSymbol{|} \AgdaBound{eq2} \AgdaSymbol{=} \AgdaFunction{liftSubst1Commute} \AgdaBound{σ} \AgdaBound{t}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaBound{x'} \AgdaInductiveConstructor{,} \AgdaBound{eq1} \AgdaInductiveConstructor{,} \AgdaBound{eq2}\AgdaSymbol{)} \AgdaKeyword{rewrite} \AgdaBound{eq1} \AgdaSymbol{|} \AgdaBound{eq2} \AgdaSymbol{=} \AgdaFunction{liftSub1Commute} \AgdaBound{σ} \AgdaBound{x'}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{liftSubst1Commute} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m'} \AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{σ} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m'} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m'}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{21}{}\<[21]%
\>[21]\AgdaFunction{liftType} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{substType} \AgdaBound{σ} \AgdaBound{t}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaFunction{substType} \AgdaSymbol{(}\AgdaFunction{liftAList1} \AgdaBound{σ}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaNumber{1} \AgdaBound{t}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{liftSubst1Commute} \AgdaBound{σ} \AgdaSymbol{(}\AgdaInductiveConstructor{TVar} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{liftSub1Commute} \AgdaBound{σ} \AgdaBound{x}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{liftSubst1Commute} \AgdaBound{σ} \AgdaInductiveConstructor{TInt} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{liftSubst1Commute} \AgdaBound{σ} \AgdaSymbol{(}\AgdaBound{t1} \AgdaInductiveConstructor{⇒} \AgdaBound{t2}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{cong₂} \AgdaInductiveConstructor{\_⇒\_} \AgdaSymbol{(}\AgdaFunction{liftSubst1Commute} \AgdaBound{σ} \AgdaBound{t1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftSubst1Commute} \AgdaBound{σ} \AgdaBound{t2}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{liftSubCommute} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m'} \AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{c} \AgdaSymbol{(}\AgdaBound{σ} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m'} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m'}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{17}{}\<[17]%
\>[17]\AgdaFunction{liftType} \AgdaBound{c} \AgdaSymbol{(}\AgdaFunction{sub} \AgdaBound{σ} \AgdaBound{x}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaFunction{sub} \AgdaSymbol{(}\AgdaFunction{liftAList} \AgdaBound{c} \AgdaBound{σ}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{inject+'} \AgdaBound{c} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{liftSubCommute} \AgdaInductiveConstructor{zero} \AgdaBound{σ} \AgdaBound{x} \AgdaKeyword{rewrite} \AgdaFunction{TVarId} \AgdaSymbol{(}\AgdaFunction{sub} \AgdaBound{σ} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{liftSubCommute} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{c}\AgdaSymbol{)} \AgdaBound{σ} \AgdaBound{x} \AgdaSymbol{=}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{begin}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{liftType} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{c}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{sub} \AgdaBound{σ} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{≡⟨} \AgdaFunction{sym} \AgdaSymbol{(}\AgdaFunction{≅-to-≡} \AgdaSymbol{(}\AgdaFunction{liftTypeAdd} \AgdaNumber{1} \AgdaBound{c} \AgdaSymbol{(}\AgdaFunction{sub} \AgdaBound{σ} \AgdaBound{x}\AgdaSymbol{)))} \AgdaFunction{⟩}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{liftType} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaBound{c} \AgdaSymbol{(}\AgdaFunction{sub} \AgdaBound{σ} \AgdaBound{x}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{≡⟨} \AgdaFunction{cong} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaNumber{1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftSubCommute} \AgdaBound{c} \AgdaBound{σ} \AgdaBound{x}\AgdaSymbol{)} \AgdaFunction{⟩}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{liftType} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{sub} \AgdaSymbol{(}\AgdaFunction{liftAList} \AgdaBound{c} \AgdaBound{σ}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{inject+'} \AgdaBound{c} \AgdaBound{x}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{≡⟨} \AgdaFunction{liftSub1Commute} \AgdaSymbol{(}\AgdaFunction{liftAList} \AgdaBound{c} \AgdaBound{σ}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{inject+'} \AgdaBound{c} \AgdaBound{x}\AgdaSymbol{)} \AgdaFunction{⟩}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaFunction{sub} \AgdaSymbol{(}\AgdaFunction{liftAList1} \AgdaSymbol{(}\AgdaFunction{liftAList} \AgdaBound{c} \AgdaBound{σ}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaFunction{inject₁} \AgdaSymbol{(}\AgdaFunction{inject+'} \AgdaBound{c} \AgdaBound{x}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{∎}\<%
\\
%
\\
\>\AgdaFunction{liftSubstCommute} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m'} \AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{c} \AgdaSymbol{(}\AgdaBound{σ} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m'} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m'}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{19}{}\<[19]%
\>[19]\AgdaFunction{liftType} \AgdaBound{c} \AgdaSymbol{(}\AgdaFunction{substType} \AgdaBound{σ} \AgdaBound{t}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaFunction{substType} \AgdaSymbol{(}\AgdaFunction{liftAList} \AgdaBound{c} \AgdaBound{σ}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaBound{c} \AgdaBound{t}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{liftSubstCommute} \AgdaBound{c} \AgdaBound{σ} \AgdaSymbol{(}\AgdaInductiveConstructor{TVar} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{liftSubCommute} \AgdaBound{c} \AgdaBound{σ} \AgdaBound{x}\<%
\\
\>\AgdaFunction{liftSubstCommute} \AgdaBound{c} \AgdaBound{σ} \AgdaInductiveConstructor{TInt} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{liftSubstCommute} \AgdaBound{c} \AgdaBound{σ} \AgdaSymbol{(}\AgdaBound{t1} \AgdaInductiveConstructor{⇒} \AgdaBound{t2}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{cong₂} \AgdaInductiveConstructor{\_⇒\_} \AgdaSymbol{(}\AgdaFunction{liftSubstCommute} \AgdaBound{c} \AgdaBound{σ} \AgdaBound{t1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftSubstCommute} \AgdaBound{c} \AgdaBound{σ} \AgdaBound{t2}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaKeyword{mutual}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{substVarAdd} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{m2} \AgdaBound{m1}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m1} \AgdaBound{m2}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{σ1} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{m1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{16}{}\<[16]%
\>[16]\AgdaFunction{sub} \AgdaBound{σ2} \AgdaFunction{◃} \AgdaFunction{sub} \AgdaBound{σ1} \AgdaBound{x} \AgdaDatatype{≡} \AgdaFunction{sub} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaFunction{+!+} \AgdaBound{σ1}\AgdaSymbol{)} \AgdaBound{x}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{substVarAdd} \AgdaBound{σ2} \AgdaInductiveConstructor{anil} \AgdaBound{x} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{substVarAdd} \AgdaBound{σ2} \AgdaSymbol{(}\AgdaBound{σ1} \AgdaInductiveConstructor{asnoc} \AgdaBound{t} \AgdaInductiveConstructor{/} \AgdaBound{y}\AgdaSymbol{)} \AgdaBound{x} \AgdaKeyword{with} \AgdaFunction{thick} \AgdaBound{y} \AgdaBound{x}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{nothing} \AgdaSymbol{=} \AgdaFunction{substTypeAdd} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaBound{t}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{just} \AgdaBound{x'} \AgdaSymbol{=} \AgdaFunction{substVarAdd} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaBound{x'}\<%
\\
%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{substTypeAdd} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{m2} \AgdaBound{m1}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m1} \AgdaBound{m2}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{σ1} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{m1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{17}{}\<[17]%
\>[17]\AgdaFunction{substType} \AgdaBound{σ2} \AgdaSymbol{(}\AgdaFunction{substType} \AgdaBound{σ1} \AgdaBound{t}\AgdaSymbol{)} \AgdaDatatype{≡} \AgdaFunction{substType} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaFunction{+!+} \AgdaBound{σ1}\AgdaSymbol{)} \AgdaBound{t}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{substTypeAdd} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaSymbol{(}\AgdaInductiveConstructor{TVar} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{substVarAdd} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaBound{x}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{substTypeAdd} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaInductiveConstructor{TInt} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{substTypeAdd} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaSymbol{(}\AgdaBound{t1} \AgdaInductiveConstructor{⇒} \AgdaBound{t2}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{cong₂} \AgdaInductiveConstructor{\_⇒\_} \AgdaSymbol{(}\AgdaFunction{substTypeAdd} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaBound{t1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{substTypeAdd} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaBound{t2}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{substLiftTypeAdd} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{m2} \AgdaBound{m1}\AgdaSymbol{\}} \AgdaBound{c2} \AgdaBound{c1} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{m1}\AgdaSymbol{)} \AgdaBound{m2}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{σ1} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaSymbol{(}\AgdaBound{c1} \AgdaPrimitive{+} \AgdaBound{m}\AgdaSymbol{)} \AgdaBound{m1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{19}{}\<[19]%
\>[19]\AgdaFunction{substType} \AgdaBound{σ2} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaBound{c2} \AgdaSymbol{(}\AgdaFunction{substType} \AgdaBound{σ1} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaBound{c1} \AgdaBound{t}\AgdaSymbol{)))} \AgdaDatatype{≅}\<%
\\
\>[2]\AgdaIndent{19}{}\<[19]%
\>[19]\AgdaFunction{substType} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaFunction{+!+} \AgdaFunction{liftAList} \AgdaBound{c2} \AgdaBound{σ1}\AgdaSymbol{)}\<%
\\
\>[19]\AgdaIndent{29}{}\<[29]%
\>[29]\AgdaSymbol{(}\AgdaFunction{subst} \AgdaDatatype{Type} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{c1}\AgdaSymbol{)} \AgdaBound{t}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{substLiftTypeAdd} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaBound{t}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{rewrite} \AgdaFunction{liftSubstCommute} \AgdaBound{c2} \AgdaBound{σ1} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaBound{c1} \AgdaBound{t}\AgdaSymbol{)}\<%
\\
\>[2]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{|} \AgdaFunction{liftTypeAdd'} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{t}\<%
\\
\>[2]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{|} \AgdaFunction{substTypeAdd} \AgdaBound{σ2} \AgdaSymbol{(}\AgdaFunction{liftAList} \AgdaBound{c2} \AgdaBound{σ1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{subst} \AgdaDatatype{Type} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{m}\AgdaSymbol{)}\<%
\\
\>[8]\AgdaIndent{53}{}\<[53]%
\>[53]\AgdaSymbol{((λ} \AgdaBound{x} \AgdaSymbol{→} \AgdaInductiveConstructor{TVar} \AgdaSymbol{(}\AgdaFunction{inject+'} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{c1}\AgdaSymbol{)} \AgdaBound{x}\AgdaSymbol{))} \AgdaFunction{◃} \AgdaBound{t}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\\
%
\\
\>\AgdaFunction{substLiftCxtAdd} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n} \AgdaBound{m2} \AgdaBound{m1}\AgdaSymbol{\}} \AgdaBound{c2} \AgdaBound{c1} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{m1}\AgdaSymbol{)} \AgdaBound{m2}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{σ1} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaSymbol{(}\AgdaBound{c1} \AgdaPrimitive{+} \AgdaBound{m}\AgdaSymbol{)} \AgdaBound{m1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{15}{}\<[15]%
\>[15]\AgdaFunction{substCxt} \AgdaBound{σ2} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c2} \AgdaSymbol{(}\AgdaFunction{substCxt} \AgdaBound{σ1} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c1} \AgdaBound{Γ}\AgdaSymbol{)))} \AgdaDatatype{≅}\<%
\\
\>[2]\AgdaIndent{15}{}\<[15]%
\>[15]\AgdaFunction{substCxt} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaFunction{+!+} \AgdaFunction{liftAList} \AgdaBound{c2} \AgdaBound{σ1}\AgdaSymbol{)}\<%
\\
\>[15]\AgdaIndent{24}{}\<[24]%
\>[24]\AgdaSymbol{(}\AgdaFunction{subst} \AgdaSymbol{(λ} \AgdaBound{m} \AgdaSymbol{→} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{c1}\AgdaSymbol{)} \AgdaBound{Γ}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{substLiftCxtAdd} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaInductiveConstructor{[]} \AgdaKeyword{rewrite} \AgdaFunction{+-assoc} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{m} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\\
\>\AgdaFunction{substLiftCxtAdd} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{rewrite} \AgdaFunction{substConsCommute} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{c1}\AgdaSymbol{)} \AgdaBound{t}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{c1}\AgdaSymbol{)} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaSymbol{=}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{hcong₂} \AgdaInductiveConstructor{\_∷\_} \AgdaSymbol{(}\AgdaFunction{substLiftTypeAdd} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaBound{t}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{substLiftCxtAdd} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaBound{Γ}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{substLiftCommute} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n} \AgdaBound{m2} \AgdaBound{m1}\AgdaSymbol{\}} \AgdaBound{c2} \AgdaBound{c1} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{m1}\AgdaSymbol{)} \AgdaBound{m2}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{σ1} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaSymbol{(}\AgdaBound{c1} \AgdaPrimitive{+} \AgdaBound{m}\AgdaSymbol{)} \AgdaBound{m1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{12}{}\<[12]%
\>[12]\AgdaSymbol{((}\AgdaFunction{subst} \AgdaSymbol{(λ} \AgdaBound{m} \AgdaSymbol{→} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{c1}\AgdaSymbol{)} \AgdaBound{Γ}\AgdaSymbol{))} \AgdaDatatype{≡} \AgdaFunction{liftCxt} \AgdaBound{c2} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c1} \AgdaBound{Γ}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{substLiftCommute} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaInductiveConstructor{[]} \AgdaKeyword{rewrite} \AgdaFunction{+-assoc} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{m} \<[61]%
\>[61]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{substLiftCommute} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaKeyword{rewrite} \AgdaFunction{substConsCommute} \AgdaSymbol{(}\AgdaFunction{+-assoc} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftType} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{c1}\AgdaSymbol{)} \AgdaBound{t}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{c1}\AgdaSymbol{)} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{cong₂} \AgdaInductiveConstructor{\_∷\_} \AgdaSymbol{(}\AgdaFunction{sym} \AgdaSymbol{(}\AgdaFunction{liftTypeAdd'} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{t}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaFunction{substLiftCommute} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaBound{Γ}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{substLiftCxtAdd2} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n} \AgdaBound{m2} \AgdaBound{m1}\AgdaSymbol{\}} \AgdaBound{c2} \AgdaBound{c1} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{m1}\AgdaSymbol{)} \AgdaBound{m2}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{σ1} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaSymbol{(}\AgdaBound{c1} \AgdaPrimitive{+} \AgdaBound{m}\AgdaSymbol{)} \AgdaBound{m1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[12]\AgdaIndent{15}{}\<[15]%
\>[15]\AgdaFunction{substCxt} \AgdaBound{σ2} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c2} \AgdaSymbol{(}\AgdaFunction{substCxt} \AgdaBound{σ1} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c1} \AgdaBound{Γ}\AgdaSymbol{)))} \AgdaDatatype{≅}\<%
\\
\>[12]\AgdaIndent{15}{}\<[15]%
\>[15]\AgdaFunction{substCxt} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaFunction{+!+} \AgdaFunction{liftAList} \AgdaBound{c2} \AgdaBound{σ1}\AgdaSymbol{)}\<%
\\
\>[15]\AgdaIndent{24}{}\<[24]%
\>[24]\AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c2} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c1} \AgdaBound{Γ}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{substLiftCxtAdd2} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaInductiveConstructor{[]} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\\
\>\AgdaFunction{substLiftCxtAdd2} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaKeyword{rewrite} \AgdaFunction{substLiftCommute} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaBound{Γ} \AgdaSymbol{=} \<[91]%
\>[91]\AgdaFunction{htrans} \AgdaSymbol{(}\AgdaFunction{substLiftCxtAdd} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{))} \AgdaSymbol{(}\AgdaFunction{hcong} \AgdaSymbol{(λ} \AgdaBound{x} \AgdaSymbol{→} \AgdaFunction{substCxt} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaFunction{+!+} \AgdaFunction{liftAList} \AgdaBound{c2} \AgdaBound{σ1}\AgdaSymbol{)} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{≡-to-≅} \AgdaSymbol{(}\AgdaFunction{substLiftCommute} \AgdaBound{c2} \AgdaBound{c1} \AgdaBound{σ2} \AgdaBound{σ1} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{∷} \AgdaBound{Γ}\AgdaSymbol{))))}\<%
\\
%
\\
\>\AgdaFunction{anilLem} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{ρ} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaInductiveConstructor{anil} \AgdaFunction{+!+} \AgdaBound{ρ} \AgdaDatatype{≡} \AgdaBound{ρ}\AgdaSymbol{)} \<[57]%
\>[57]\<%
\\
\>\AgdaFunction{anilLem} \AgdaInductiveConstructor{anil} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{anilLem} \AgdaSymbol{(}\AgdaBound{r} \AgdaInductiveConstructor{asnoc} \AgdaBound{t'} \AgdaInductiveConstructor{/} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{cong} \AgdaSymbol{(λ} \AgdaBound{x₁} \AgdaSymbol{→} \AgdaBound{x₁} \AgdaInductiveConstructor{asnoc} \AgdaBound{t'} \AgdaInductiveConstructor{/} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{anilLem} \AgdaBound{r}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{lift1SucLem} \AgdaSymbol{:} \AgdaSymbol{∀\{}\AgdaBound{m} \AgdaBound{m1} \AgdaBound{m2} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{σ1} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{m1}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m1} \AgdaBound{m2}\AgdaSymbol{)} \<[70]%
\>[70]\<%
\\
\>[0]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{→} \<[14]%
\>[14]\AgdaFunction{liftAList1} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaFunction{+!+} \AgdaBound{σ1}\AgdaSymbol{)} \AgdaDatatype{≅} \AgdaFunction{liftAList1} \AgdaBound{σ2} \AgdaFunction{+!+} \AgdaFunction{liftAList1} \AgdaBound{σ1}\<%
\\
\>\AgdaFunction{lift1SucLem} \AgdaInductiveConstructor{anil} \AgdaBound{σ2} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\\
\>\AgdaFunction{lift1SucLem} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{asnoc} \AgdaBound{t'} \AgdaInductiveConstructor{/} \AgdaBound{x}\AgdaSymbol{)} \AgdaBound{σ2} \AgdaSymbol{=} \AgdaFunction{hcong} \AgdaSymbol{(λ} \AgdaBound{x₁} \AgdaSymbol{→} \AgdaBound{x₁} \AgdaInductiveConstructor{asnoc} \AgdaFunction{liftType} \AgdaNumber{1} \AgdaBound{t'} \AgdaInductiveConstructor{/} \AgdaFunction{inject₁} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lift1SucLem} \AgdaBound{t} \AgdaBound{σ2}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{liftAListanil} \AgdaSymbol{:} \AgdaSymbol{∀\{}\AgdaBound{m} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{liftAList} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n} \AgdaInductiveConstructor{anil} \AgdaDatatype{≅} \<[49]%
\>[49]\AgdaInductiveConstructor{anil}\<%
\\
\>\AgdaFunction{liftAListanil} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\\
\>\AgdaFunction{liftAListanil} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{hcong} \AgdaSymbol{(}\AgdaFunction{liftAList1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftAListanil} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\})}\<%
\\
%
\\
%
\\
\>\AgdaFunction{lift1Suc} \AgdaSymbol{:} \AgdaSymbol{∀\{}\AgdaBound{m} \AgdaBound{m1} \AgdaBound{m2} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \<[29]%
\>[29]\AgdaSymbol{(}\AgdaBound{c1} \AgdaBound{c2} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{σ1} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaSymbol{(}\AgdaBound{c1} \AgdaPrimitive{+} \AgdaBound{m}\AgdaSymbol{)} \AgdaBound{m1}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaSymbol{(}\AgdaBound{c2} \AgdaPrimitive{+} \AgdaBound{m1}\AgdaSymbol{)} \AgdaBound{m2}\AgdaSymbol{)} \<[96]%
\>[96]\<%
\\
\>[0]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{→} \<[14]%
\>[14]\AgdaSymbol{(}\AgdaFunction{liftAList} \AgdaNumber{1} \AgdaSymbol{(}\AgdaBound{σ2} \AgdaFunction{+!+} \AgdaSymbol{(}\AgdaFunction{liftAList} \AgdaBound{c2} \AgdaBound{σ1}\AgdaSymbol{)))} \AgdaDatatype{≅} \AgdaSymbol{((}\AgdaFunction{liftAList} \AgdaNumber{1} \AgdaBound{σ2}\AgdaSymbol{)} \AgdaFunction{+!+} \AgdaSymbol{(}\AgdaFunction{liftAList} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{c2}\AgdaSymbol{))} \AgdaBound{σ1}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lift1Suc} \AgdaBound{c1} \AgdaBound{c2} \AgdaBound{σ1} \AgdaBound{σ2} \AgdaKeyword{rewrite} \AgdaSymbol{(}\AgdaFunction{anilLem} \AgdaSymbol{(}\AgdaFunction{liftAList1} \AgdaSymbol{(}\AgdaFunction{liftAList1} \AgdaSymbol{(}\AgdaFunction{liftAList} \AgdaBound{c2} \AgdaBound{σ1}\AgdaSymbol{))))} \AgdaSymbol{=} \AgdaFunction{lift1SucLem} \AgdaSymbol{(}\AgdaFunction{liftAList} \AgdaBound{c2} \AgdaBound{σ1}\AgdaSymbol{)} \AgdaBound{σ2}\<%
\\
%
\\
\>\AgdaFunction{liftCxtAddEqLem} \AgdaSymbol{:} \AgdaSymbol{∀(}\AgdaBound{c1} \AgdaBound{c2} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaNumber{1} \AgdaPrimitive{+} \AgdaBound{c2}\AgdaSymbol{)} \AgdaPrimitive{+} \AgdaBound{c1} \AgdaDatatype{≡} \AgdaSymbol{(}\AgdaBound{c1} \AgdaPrimitive{+} \AgdaInductiveConstructor{suc} \AgdaBound{c2}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{liftCxtAddEqLem} \AgdaBound{c1} \AgdaBound{c2} \AgdaKeyword{rewrite} \AgdaFunction{+-comm} \AgdaBound{c2} \AgdaBound{c1} \AgdaSymbol{=} \AgdaFunction{sym} \AgdaSymbol{(}\AgdaFunction{+-suc} \AgdaBound{c1} \AgdaBound{c2}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{liftCxtAddEq} \AgdaSymbol{:} \AgdaSymbol{∀\{}\AgdaBound{m} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \<[29]%
\>[29]\AgdaSymbol{(}\AgdaBound{c1} \AgdaBound{c2} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaFunction{liftCxt} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c2} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c1} \AgdaBound{Γ}\AgdaSymbol{))} \AgdaDatatype{≅} \AgdaFunction{liftCxt} \AgdaSymbol{(}\AgdaBound{c1} \AgdaPrimitive{+} \AgdaInductiveConstructor{suc} \AgdaBound{c2}\AgdaSymbol{)} \AgdaBound{Γ}\<%
\\
\>\AgdaFunction{liftCxtAddEq} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaBound{c1} \AgdaBound{c2} \AgdaBound{Γ} \<[30]%
\>[30]\AgdaSymbol{=}\<%
\\
\>[11]\AgdaIndent{27}{}\<[27]%
\>[27]\AgdaFunction{H.begin}\<%
\\
\>[27]\AgdaIndent{29}{}\<[29]%
\>[29]\AgdaFunction{liftCxt} \AgdaNumber{1} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c2} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c1} \AgdaBound{Γ}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{27}{}\<[27]%
\>[27]\AgdaFunction{H.≅⟨} \AgdaFunction{liftCxtAdd} \AgdaNumber{1} \AgdaBound{c2} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c1} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaFunction{⟩}\<%
\\
\>[27]\AgdaIndent{29}{}\<[29]%
\>[29]\AgdaFunction{liftCxt} \AgdaSymbol{(}\AgdaNumber{1} \AgdaPrimitive{+} \AgdaBound{c2}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{liftCxt} \AgdaBound{c1} \AgdaBound{Γ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{27}{}\<[27]%
\>[27]\AgdaFunction{H.≅⟨} \AgdaFunction{liftCxtAdd} \AgdaSymbol{(}\AgdaNumber{1} \AgdaPrimitive{+} \AgdaBound{c2}\AgdaSymbol{)} \AgdaBound{c1} \AgdaBound{Γ} \AgdaFunction{⟩}\<%
\\
\>[27]\AgdaIndent{29}{}\<[29]%
\>[29]\AgdaFunction{liftCxt} \AgdaSymbol{((}\AgdaNumber{1} \AgdaPrimitive{+} \AgdaBound{c2}\AgdaSymbol{)} \AgdaPrimitive{+} \AgdaBound{c1}\AgdaSymbol{)} \AgdaBound{Γ}\<%
\\
\>[0]\AgdaIndent{27}{}\<[27]%
\>[27]\AgdaFunction{H.≅⟨} \AgdaFunction{hcong} \AgdaSymbol{(λ} \AgdaBound{x} \AgdaSymbol{→} \AgdaFunction{liftCxt} \AgdaBound{x} \AgdaBound{Γ}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{≡-to-≅} \AgdaSymbol{(}\AgdaFunction{liftCxtAddEqLem} \AgdaBound{c1} \AgdaBound{c2}\AgdaSymbol{))} \AgdaFunction{⟩}\<%
\\
\>[27]\AgdaIndent{29}{}\<[29]%
\>[29]\AgdaFunction{liftCxt} \AgdaSymbol{(}\AgdaBound{c1} \AgdaPrimitive{+} \AgdaInductiveConstructor{suc} \AgdaBound{c2}\AgdaSymbol{)} \AgdaBound{Γ} \<[72]%
\>[72]\<%
\\
\>[0]\AgdaIndent{28}{}\<[28]%
\>[28]\<%
\\
\>[0]\AgdaIndent{27}{}\<[27]%
\>[27]\AgdaFunction{H.∎}\<%
\\
%
\\
\>\AgdaFunction{substLiftCxtEq} \AgdaSymbol{:} \AgdaSymbol{∀\{}\AgdaBound{m} \AgdaBound{m1} \AgdaBound{m2} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{σ1} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m1} \AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{σ2} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m2} \AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{→}\<%
\\
\>[27]\AgdaIndent{39}{}\<[39]%
\>[39]\AgdaSymbol{\{}\AgdaBound{Γ1} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m1}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{\{}\AgdaBound{Γ2} \AgdaSymbol{:} \AgdaFunction{Cxt} \AgdaSymbol{\{}\AgdaBound{m2}\AgdaSymbol{\}} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{m1} \AgdaDatatype{≡} \AgdaBound{m2} \AgdaSymbol{→}\<%
\\
\>[39]\AgdaIndent{49}{}\<[49]%
\>[49]\AgdaBound{σ1} \AgdaDatatype{≅} \AgdaBound{σ2} \AgdaSymbol{→} \AgdaBound{Γ1} \AgdaDatatype{≅} \AgdaBound{Γ2} \AgdaSymbol{→}\<%
\\
\>[49]\AgdaIndent{51}{}\<[51]%
\>[51]\AgdaFunction{substCxt} \AgdaBound{σ1} \AgdaBound{Γ1} \AgdaDatatype{≅} \AgdaFunction{substCxt} \AgdaBound{σ2} \AgdaBound{Γ2}\<%
\\
\>\AgdaFunction{substLiftCxtEq} \AgdaInductiveConstructor{refl} \AgdaInductiveConstructor{hrefl} \AgdaInductiveConstructor{hrefl} \AgdaSymbol{=} \AgdaInductiveConstructor{hrefl}\<%
\end{code}
}
