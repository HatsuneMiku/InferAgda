\agdaIgnore{
\begin{code}%
\>\AgdaKeyword{module} \AgdaModule{Library} \AgdaKeyword{where}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary.PropositionalEquality}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{Relation.}\AgdaModule{Binary.}\AgdaModule{PropositionalEquality.}\AgdaModule{≡-Reasoning} \<[55]%
\>[55]\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Nat}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Product}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Empty}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Fin}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Sum}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Bool}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Maybe}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.List}\<%
\\
\>\AgdaKeyword{import} \AgdaModule{Level}\<%
\end{code}}

\agdaSnippet\LeftF{
\begin{code}%
\>\AgdaFunction{lf} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{S} \AgdaBound{T} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaBound{S} \AgdaSymbol{→} \AgdaBound{T}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{S} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{T}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lf} \AgdaBound{f} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{x} \AgdaSymbol{→} \AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaBound{f} \AgdaBound{x}\AgdaSymbol{)}\<%
\end{code}}

\agdaSnippet\RightF{
\begin{code}%
\>\AgdaFunction{rf} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{S} \AgdaBound{T} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaBound{S} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{T}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Maybe} \AgdaBound{S} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{T}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{rf} \AgdaBound{f} \AgdaInductiveConstructor{nothing} \AgdaSymbol{=} \AgdaInductiveConstructor{nothing}\<%
\\
\>\AgdaFunction{rf} \AgdaBound{f} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaBound{f} \AgdaBound{x}\<%
\end{code}}

\agdaSnippet\LRFA{
\begin{code}%
\>\AgdaFunction{lrf} \AgdaSymbol{:\{}\AgdaBound{S} \AgdaBound{T} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaBound{S} \AgdaSymbol{→} \AgdaBound{T}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Maybe} \AgdaBound{S} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{T}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lrf} \AgdaBound{f} \AgdaSymbol{=} \AgdaFunction{rf} \AgdaSymbol{(}\AgdaFunction{lf} \AgdaBound{f}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{\_∘\_} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{A} \AgdaBound{B} \AgdaBound{C} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaBound{B} \AgdaSymbol{→} \AgdaBound{C}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{g} \AgdaSymbol{:} \AgdaBound{A} \AgdaSymbol{→} \AgdaBound{B}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{A} \AgdaSymbol{→} \AgdaBound{C}\AgdaSymbol{)}\<%
\\
\>\AgdaBound{f} \AgdaFunction{∘} \AgdaBound{g} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{x} \AgdaSymbol{→} \AgdaBound{f} \AgdaSymbol{(}\AgdaBound{g} \AgdaBound{x}\AgdaSymbol{)}\<%
\end{code}}

\agdaSnippet\LRFB{
\begin{code}%
\>\AgdaFunction{lf2} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{R} \AgdaBound{S} \AgdaBound{T} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaBound{R} \AgdaSymbol{→} \AgdaBound{S} \AgdaSymbol{→} \AgdaBound{T}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{R} \AgdaSymbol{→} \AgdaBound{S} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{T}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lf2} \AgdaBound{f} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{x} \AgdaBound{x₁} \AgdaSymbol{→} \AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaBound{f} \AgdaBound{x} \AgdaBound{x₁}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{rf2} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{R} \AgdaBound{S} \AgdaBound{T} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaBound{R} \AgdaSymbol{→} \AgdaBound{S} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{T}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{R} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{S} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{T}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{rf2} \AgdaBound{f} \AgdaBound{x} \AgdaInductiveConstructor{nothing} \AgdaSymbol{=} \AgdaInductiveConstructor{nothing}\<%
\\
\>\AgdaFunction{rf2} \AgdaBound{f} \AgdaBound{x} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaBound{x₁}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaBound{f} \AgdaBound{x} \AgdaBound{x₁}\<%
\\
%
\\
\>\AgdaFunction{cf2} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{R} \AgdaBound{S} \AgdaBound{T} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaBound{R} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{S} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{T}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Maybe} \AgdaBound{R} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{S} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{T}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{cf2} \AgdaBound{f} \AgdaInductiveConstructor{nothing} \AgdaInductiveConstructor{nothing} \AgdaSymbol{=} \AgdaInductiveConstructor{nothing}\<%
\\
\>\AgdaFunction{cf2} \AgdaBound{f} \AgdaInductiveConstructor{nothing} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{nothing}\<%
\\
\>\AgdaFunction{cf2} \AgdaBound{f} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaBound{x}\AgdaSymbol{)} \AgdaInductiveConstructor{nothing} \AgdaSymbol{=} \AgdaBound{f} \AgdaBound{x} \AgdaInductiveConstructor{nothing}\<%
\\
\>\AgdaFunction{cf2} \AgdaBound{f} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaBound{x₁}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaBound{f} \AgdaBound{x} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaBound{x₁}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{lrf2} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{R} \AgdaBound{S} \AgdaBound{T} \AgdaSymbol{:} \AgdaPrimitiveType{Set}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaBound{R} \AgdaSymbol{→} \AgdaBound{S} \AgdaSymbol{→} \AgdaBound{T}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Maybe} \AgdaBound{R} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{S} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaBound{T}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lrf2} \AgdaBound{f} \AgdaSymbol{=} \AgdaFunction{cf2} \AgdaSymbol{(}\AgdaFunction{rf2} \AgdaSymbol{(}\AgdaFunction{lf2} \AgdaBound{f}\AgdaSymbol{))}\<%
\end{code}}

\agdaSnippet\SetTheory{
\begin{code}%
\>\AgdaKeyword{record} \AgdaRecord{Top} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
%
\\
\>\AgdaKeyword{data} \AgdaDatatype{Bot} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
%
\\
\>\AgdaFunction{empty} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaInductiveConstructor{zero} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaFunction{empty} \AgdaBound{x} \AgdaSymbol{=} \AgdaRecord{Top}\<%
\\
\>\<%
\end{code}}

\agdaSnippet\DepTypeDef{
\begin{code}%
\>\AgdaKeyword{data} \AgdaDatatype{Type} \AgdaSymbol{(}\AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{)} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaInductiveConstructor{ι} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n} \<[28]%
\>[28]\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaInductiveConstructor{leaf} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{n}\<%
\\
\>[0]\AgdaIndent{3}{}\<[3]%
\>[3]\AgdaInductiveConstructor{\_fork\_} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{s} \AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n} \<%
\end{code}}

\agdaSnippet\LiftFinToType{
\begin{code}%
\>\AgdaFunction{▹} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{n} \AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{r} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Fin} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Fin} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{▹} \AgdaBound{r} \AgdaSymbol{=} \AgdaInductiveConstructor{ι} \AgdaFunction{∘} \AgdaBound{r}\<%
\\
%
\\
\>\AgdaFunction{\_◃\_} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{n} \AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Type} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{\_◃\_} \AgdaBound{f} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaBound{f} \AgdaBound{x}\<%
\\
\>\AgdaFunction{\_◃\_} \AgdaBound{f} \AgdaInductiveConstructor{leaf} \AgdaSymbol{=} \AgdaInductiveConstructor{leaf}\<%
\\
\>\AgdaFunction{\_◃\_} \AgdaBound{f} \AgdaSymbol{(}\AgdaBound{s} \AgdaInductiveConstructor{fork} \AgdaBound{t}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaSymbol{(}\AgdaBound{f} \AgdaFunction{◃} \AgdaBound{s}\AgdaSymbol{)} \AgdaInductiveConstructor{fork} \AgdaSymbol{(}\AgdaBound{f} \AgdaFunction{◃} \AgdaBound{t}\AgdaSymbol{)} \<[40]%
\>[40]\<%
\\
%
\\
\>\AgdaFunction{\_◃} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{n} \AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Type} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>\AgdaBound{f} \AgdaFunction{◃} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{x} \AgdaSymbol{→} \AgdaBound{f} \AgdaFunction{◃} \AgdaBound{x}\<%
\\
%
\\
\>\AgdaFunction{▹◃} \AgdaSymbol{:} \<[6]%
\>[6]\AgdaSymbol{\{}\AgdaBound{n} \AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Fin} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Type} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{▹◃} \AgdaBound{f} \AgdaSymbol{=} \AgdaSymbol{(}\AgdaFunction{▹} \AgdaBound{f}\AgdaSymbol{)} \AgdaFunction{◃}\<%
\\
\>\<%
\end{code}}

\agdaSnippet\Equalities{
\begin{code}%
\>\AgdaFunction{\_≐\_} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{n} \AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaBound{g} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaFunction{\_≐\_} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{f} \AgdaBound{g} \AgdaSymbol{=} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{f} \AgdaBound{x} \AgdaDatatype{≡} \AgdaBound{g} \AgdaBound{x}\<%
\\
%
\\
\>\AgdaFunction{\_◇\_} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n} \AgdaBound{l} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{f} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{g} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{l} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Fin} \AgdaBound{l} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>\AgdaBound{f} \AgdaFunction{◇} \AgdaBound{g} \AgdaSymbol{=} \AgdaSymbol{(}\AgdaBound{f} \AgdaFunction{◃}\AgdaSymbol{)} \AgdaFunction{∘} \AgdaBound{g}\<%
\end{code}}

\agdaSnippet\Thin{
\begin{code}%
\>\AgdaFunction{thin} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{Fin} \AgdaBound{n} \AgdaSymbol{→} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \<[51]%
\>[51]\<%
\\
\>\AgdaFunction{thin} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaInductiveConstructor{zero} \AgdaBound{y} \AgdaSymbol{=} \AgdaInductiveConstructor{suc} \AgdaBound{y}\<%
\\
\>\AgdaFunction{thin} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{x}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaSymbol{=} \AgdaInductiveConstructor{zero}\<%
\\
\>\AgdaFunction{thin} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaFunction{thin} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{)}\<%
\end{code}}

\agdaSnippet\ThickenFun{
\begin{code}%
\>\AgdaFunction{thick} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{))} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaSymbol{(}\AgdaDatatype{Fin} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{thick} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaInductiveConstructor{zero} \AgdaInductiveConstructor{zero} \AgdaSymbol{=} \AgdaInductiveConstructor{nothing}\<%
\\
\>\AgdaFunction{thick} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaInductiveConstructor{zero} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{just} \AgdaBound{y}\<%
\\
\>\AgdaFunction{thick} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaSymbol{())} \AgdaInductiveConstructor{zero}\<%
\\
\>\AgdaFunction{thick} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{x}\AgdaSymbol{)} \AgdaInductiveConstructor{zero} \AgdaSymbol{=} \AgdaInductiveConstructor{just} \AgdaInductiveConstructor{zero}\<%
\\
\>\AgdaFunction{thick} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaSymbol{())} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{y}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{thick} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{lrf} \AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaFunction{thick} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{)}\<%
\end{code}}

\agdaSnippet\CheckType{
\begin{code}%
\>\AgdaFunction{check} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaSymbol{(}\AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{check} \AgdaBound{x} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaBound{y}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{lrf} \AgdaInductiveConstructor{ι} \AgdaSymbol{(}\AgdaFunction{thick} \AgdaBound{x} \AgdaBound{y}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{check} \AgdaBound{x} \AgdaInductiveConstructor{leaf} \AgdaSymbol{=} \AgdaInductiveConstructor{just} \AgdaInductiveConstructor{leaf}\<%
\\
\>\AgdaFunction{check} \AgdaBound{x} \AgdaSymbol{(}\AgdaBound{s} \AgdaInductiveConstructor{fork} \AgdaBound{t}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{lrf2} \AgdaInductiveConstructor{\_fork\_} \AgdaSymbol{(}\AgdaFunction{check} \AgdaBound{x} \AgdaBound{s}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{check} \AgdaBound{x} \AgdaBound{t}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{\_for\_} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{t'} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>[3]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{))} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{\_for\_} \AgdaBound{t'} \AgdaBound{x} \AgdaBound{y} \AgdaKeyword{with} \AgdaFunction{thick} \AgdaBound{x} \AgdaBound{y}\<%
\\
\>\AgdaFunction{\_for\_} \AgdaBound{t'} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{|} \AgdaInductiveConstructor{nothing} \AgdaSymbol{=} \AgdaBound{t'}\<%
\\
\>\AgdaFunction{\_for\_} \AgdaBound{t'} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{|} \AgdaInductiveConstructor{just} \AgdaBound{y'} \AgdaSymbol{=} \AgdaInductiveConstructor{ι} \AgdaBound{y'}\<%
\end{code}}

\agdaSnippet\AList{
\begin{code}%
\>\AgdaKeyword{data} \AgdaDatatype{AList} \AgdaSymbol{:} \AgdaDatatype{ℕ} \AgdaSymbol{→} \AgdaDatatype{ℕ} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{anil} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{m}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{\_asnoc\_/\_} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{σ} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→}\<%
\\
\>[2]\AgdaIndent{14}{}\<[14]%
\>[14]\AgdaSymbol{(}\AgdaBound{t'} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{))} \AgdaSymbol{→} \AgdaDatatype{AList} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaBound{n}\<%
\end{code}}
\agdaSnippet\Asnoc{
\begin{code}%
\>\AgdaFunction{\_asnoc'\_/\_} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{a} \AgdaSymbol{:} \AgdaFunction{∃} \AgdaSymbol{(}\AgdaDatatype{AList} \AgdaBound{m}\AgdaSymbol{))} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{t'} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{))} \AgdaSymbol{→} \AgdaFunction{∃} \AgdaSymbol{(}\AgdaDatatype{AList} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{))}\<%
\\
\>\AgdaSymbol{(} \AgdaBound{s} \AgdaInductiveConstructor{,} \AgdaBound{t} \AgdaSymbol{)} \AgdaFunction{asnoc'} \AgdaBound{t'} \AgdaFunction{/} \AgdaBound{x} \AgdaSymbol{=} \AgdaSymbol{(} \AgdaBound{s} \AgdaInductiveConstructor{,} \AgdaBound{t} \AgdaInductiveConstructor{asnoc} \AgdaBound{t'} \AgdaInductiveConstructor{/} \AgdaBound{x} \AgdaSymbol{)}\<%
\end{code}}

\agdaSnippet\Subst{
\begin{code}%
\>\AgdaFunction{sub} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{σ} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{Fin} \AgdaBound{m} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaBound{n}\<%
\\
\>\AgdaFunction{sub} \AgdaInductiveConstructor{anil} \AgdaSymbol{=} \AgdaInductiveConstructor{ι} \<[13]%
\>[13]\<%
\\
\>\AgdaFunction{sub} \AgdaSymbol{(}\AgdaBound{σ} \AgdaInductiveConstructor{asnoc} \AgdaBound{t'} \AgdaInductiveConstructor{/} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaSymbol{(}\AgdaFunction{sub} \AgdaBound{σ}\AgdaSymbol{)} \AgdaFunction{◇} \AgdaSymbol{(}\AgdaBound{t'} \AgdaFunction{for} \AgdaBound{x}\AgdaSymbol{)}\<%
\end{code}}

\agdaSnippet\AppendAList{
\begin{code}%
\>\AgdaFunction{\_⊹⊹\_} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{l} \AgdaBound{m} \AgdaBound{n} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{ρ} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{m} \AgdaBound{n}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{σ} \AgdaSymbol{:} \AgdaDatatype{AList} \AgdaBound{l} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \<[58]%
\>[58]\AgdaDatatype{AList} \AgdaBound{l} \AgdaBound{n}\<%
\\
\>\AgdaBound{ρ} \AgdaFunction{⊹⊹} \AgdaInductiveConstructor{anil} \AgdaSymbol{=} \AgdaBound{ρ}\<%
\\
\>\AgdaBound{ρ} \AgdaFunction{⊹⊹} \AgdaSymbol{(}\AgdaBound{alist} \AgdaInductiveConstructor{asnoc} \AgdaBound{t} \AgdaInductiveConstructor{/} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaSymbol{(}\AgdaBound{ρ} \AgdaFunction{⊹⊹} \AgdaBound{alist}\AgdaSymbol{)} \AgdaInductiveConstructor{asnoc} \AgdaBound{t} \AgdaInductiveConstructor{/} \AgdaBound{x}\<%
\end{code}}

\agdaSnippet\Flex{
\begin{code}%
\>\AgdaFunction{flexFlex} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaFunction{∃} \AgdaSymbol{(}\AgdaDatatype{AList} \AgdaBound{m}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{flexFlex} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{x} \AgdaBound{y} \AgdaKeyword{with} \AgdaFunction{thick} \AgdaBound{x} \AgdaBound{y} \<[36]%
\>[36]\<%
\\
\>\AgdaFunction{flexFlex} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{|} \AgdaInductiveConstructor{nothing} \AgdaSymbol{=} \AgdaSymbol{(} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{)} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{anil} \AgdaSymbol{)}\<%
\\
\>\AgdaFunction{flexFlex} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{x} \AgdaBound{y} \AgdaSymbol{|} \AgdaInductiveConstructor{just} \AgdaBound{y'} \AgdaSymbol{=} \AgdaSymbol{(} \AgdaBound{m} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{anil} \AgdaInductiveConstructor{asnoc} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaBound{y'}\AgdaSymbol{)} \AgdaInductiveConstructor{/} \AgdaBound{x} \AgdaSymbol{)}\<%
\\
\>\AgdaFunction{flexFlex} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{()} \AgdaBound{y}\<%
\end{code}}

\agdaSnippet\Rigid{
\begin{code}%
\>\AgdaFunction{flexRigid} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{Fin} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaSymbol{(}\AgdaFunction{∃} \AgdaSymbol{(}\AgdaDatatype{AList} \AgdaBound{m}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{flexRigid} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{()} \AgdaBound{t}\<%
\\
\>\AgdaFunction{flexRigid} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{x} \AgdaBound{t} \AgdaKeyword{with} \AgdaFunction{check} \AgdaBound{x} \AgdaBound{t}\<%
\\
\>\AgdaFunction{flexRigid} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{x} \AgdaBound{t} \AgdaSymbol{|} \AgdaInductiveConstructor{nothing} \AgdaSymbol{=} \AgdaInductiveConstructor{nothing}\<%
\\
\>\AgdaFunction{flexRigid} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{x} \AgdaBound{t} \AgdaSymbol{|} \AgdaInductiveConstructor{just} \AgdaBound{t'} \AgdaSymbol{=} \AgdaInductiveConstructor{just} \AgdaSymbol{(} \AgdaBound{m} \AgdaInductiveConstructor{,} \AgdaSymbol{(}\AgdaInductiveConstructor{anil} \AgdaInductiveConstructor{asnoc} \AgdaBound{t'} \AgdaInductiveConstructor{/} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{)}\<%
\end{code}}

\agdaSnippet\Mgu{
\begin{code}%
\>\AgdaFunction{amgu} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{s} \AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{acc} \AgdaSymbol{:} \AgdaFunction{∃} \AgdaSymbol{(}\AgdaDatatype{AList} \AgdaBound{m}\AgdaSymbol{))} \AgdaSymbol{→} \<[57]%
\>[57]\AgdaDatatype{Maybe} \AgdaSymbol{(}\AgdaFunction{∃} \AgdaSymbol{(}\AgdaDatatype{AList} \AgdaBound{m}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{amgu} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{s} \AgdaBound{t} \AgdaSymbol{(} \AgdaBound{n} \AgdaInductiveConstructor{,} \AgdaBound{σ} \AgdaInductiveConstructor{asnoc} \AgdaBound{r} \AgdaInductiveConstructor{/} \AgdaBound{z} \AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaSymbol{=} \AgdaFunction{lrf} \AgdaSymbol{(λ} \AgdaBound{σ₁} \AgdaSymbol{→} \AgdaBound{σ₁} \AgdaFunction{asnoc'} \AgdaBound{r} \AgdaFunction{/} \AgdaBound{z}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{amgu} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{((}\AgdaBound{r} \AgdaFunction{for} \AgdaBound{z}\AgdaSymbol{)} \AgdaFunction{◃} \AgdaBound{s}\AgdaSymbol{)} \AgdaSymbol{((}\AgdaBound{r} \AgdaFunction{for} \AgdaBound{z}\AgdaSymbol{)} \AgdaFunction{◃} \AgdaBound{t}\AgdaSymbol{)} \AgdaSymbol{(} \AgdaBound{n} \AgdaInductiveConstructor{,} \AgdaBound{σ} \AgdaSymbol{))}\<%
\\
\>\AgdaFunction{amgu} \AgdaInductiveConstructor{leaf} \AgdaInductiveConstructor{leaf} \AgdaBound{acc} \AgdaSymbol{=} \AgdaInductiveConstructor{just} \AgdaBound{acc}\<%
\\
\>\AgdaFunction{amgu} \AgdaInductiveConstructor{leaf} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{fork} \AgdaBound{t₁}\AgdaSymbol{)} \AgdaBound{acc} \AgdaSymbol{=} \AgdaInductiveConstructor{nothing}\<%
\\
\>\AgdaFunction{amgu} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaBound{x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaBound{x₁}\AgdaSymbol{)} \AgdaSymbol{(} \AgdaBound{s} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{anil} \AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaFunction{flexFlex} \AgdaBound{x} \AgdaBound{x₁}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{amgu} \AgdaBound{t} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaBound{x}\AgdaSymbol{)} \AgdaBound{acc} \AgdaSymbol{=} \AgdaFunction{flexRigid} \AgdaBound{x} \AgdaBound{t}\<%
\\
\>\AgdaFunction{amgu} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaBound{x}\AgdaSymbol{)} \AgdaBound{t} \AgdaBound{acc} \AgdaSymbol{=} \AgdaFunction{flexRigid} \AgdaBound{x} \AgdaBound{t}\<%
\\
\>\AgdaFunction{amgu} \AgdaSymbol{(}\AgdaBound{s} \AgdaInductiveConstructor{fork} \AgdaBound{s₁}\AgdaSymbol{)} \AgdaInductiveConstructor{leaf} \AgdaBound{acc} \AgdaSymbol{=} \AgdaInductiveConstructor{nothing}\<%
\\
\>\AgdaFunction{amgu} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{s} \AgdaInductiveConstructor{fork} \AgdaBound{s₁}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{t} \AgdaInductiveConstructor{fork} \AgdaBound{t₁}\AgdaSymbol{)} \AgdaBound{acc} \AgdaSymbol{=} \AgdaFunction{rf} \AgdaSymbol{(}\AgdaFunction{amgu} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{s₁} \AgdaBound{t₁}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{amgu} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{s} \AgdaBound{t} \AgdaBound{acc}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{mgu} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{m} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{s} \AgdaBound{t} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaBound{m}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaDatatype{Maybe} \AgdaSymbol{(}\AgdaFunction{∃} \AgdaSymbol{(}\AgdaDatatype{AList} \AgdaBound{m}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{mgu} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{s} \AgdaBound{t} \AgdaSymbol{=} \AgdaFunction{amgu} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{s} \AgdaBound{t} \AgdaSymbol{(} \AgdaBound{m} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{anil} \AgdaSymbol{)}\<%
\end{code}}

\agdaSnippet\LibTests{
\begin{code}%
\>\AgdaFunction{t1} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaNumber{4}\<%
\\
\>\AgdaFunction{t1} \AgdaSymbol{=} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaInductiveConstructor{zero}\AgdaSymbol{)} \AgdaInductiveConstructor{fork} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaInductiveConstructor{zero}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{t2} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaNumber{4}\<%
\\
\>\AgdaFunction{t2} \AgdaSymbol{=} \AgdaSymbol{((}\AgdaInductiveConstructor{ι} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaInductiveConstructor{zero}\AgdaSymbol{))} \AgdaInductiveConstructor{fork} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaInductiveConstructor{zero}\AgdaSymbol{))))} \AgdaInductiveConstructor{fork} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaInductiveConstructor{zero}\AgdaSymbol{))))}\<%
\\
%
\\
\>\AgdaFunction{u12} \AgdaSymbol{:} \AgdaDatatype{Maybe} \AgdaSymbol{(}\AgdaFunction{∃} \AgdaSymbol{(}\AgdaDatatype{AList} \AgdaNumber{4}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{u12} \AgdaSymbol{=} \AgdaSymbol{(}\AgdaFunction{mgu} \AgdaFunction{t1} \AgdaFunction{t2}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{t3} \AgdaSymbol{:} \AgdaDatatype{Type} \AgdaNumber{4}\<%
\\
\>\AgdaFunction{t3} \AgdaSymbol{=} \AgdaSymbol{((}\AgdaInductiveConstructor{ι} \AgdaInductiveConstructor{zero}\AgdaSymbol{)} \AgdaInductiveConstructor{fork} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaInductiveConstructor{zero}\AgdaSymbol{))))} \AgdaInductiveConstructor{fork} \AgdaSymbol{(}\AgdaInductiveConstructor{ι} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaInductiveConstructor{zero}\AgdaSymbol{))))}\<%
\\
%
\\
\>\AgdaFunction{u13} \AgdaSymbol{:} \AgdaDatatype{Maybe} \AgdaSymbol{(}\AgdaFunction{∃} \AgdaSymbol{(}\AgdaDatatype{AList} \AgdaNumber{4}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{u13} \AgdaSymbol{=} \AgdaSymbol{(}\AgdaFunction{mgu} \AgdaFunction{t1} \AgdaFunction{t3}\AgdaSymbol{)}\<%
\\
\>\<%
\end{code}}
